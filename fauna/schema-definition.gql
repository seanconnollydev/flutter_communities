type Mutation {
  createPost(data: CreatePostInput!): Post! @resolver(name: "create_post")
  createPostComment(data: CreatePostCommentInput!): PostComment! @resolver(name: "create_post_comment")
  createPostVote(data: CreatePostVoteInput!): Post! @resolver(name: "create_post_vote")
  createUser(data: CreateUserInput!): String! @resolver(name: "create_user")
  loginUser(data: LoginUserInput!): String! @resolver(name: "login_user")
}

type Query {
  communities: [Community!]!
  getPostsByCommunityId(id: ID!): [Post]! @resolver(name: "get_posts_by_community_id", paginated: true)
  getPostCommentsByPostId(id: ID!): [PostComment]! @resolver(name: "get_post_comments_by_post_id", paginated: true)
  throwsError: Community! @resolver(name: "throws_error")
  viewer: User! @resolver(name: "viewer")
}

type User {
  username: String! @unique
  avatar: String
  communities: [Community!] @relation(name: "user_communities")
  posts: [Post!] @relation(name: "user_posts")
  post_votes: [PostVote!] @relation(name: "user_post_votes")
  post_comments: [PostComment!] @relation(name: "user_post_comments")
}

input CreatePostInput {
  title: String!
  message: String!
  communityId: String!
}

input CreatePostCommentInput {
  message: String!
  postId: String!
}

input CreateUserInput {
  username: String!
  password: String!
  avatar: String
}

input LoginUserInput {
  username: String!
  password: String!
}

input CreatePostVoteInput {
  postId: ID!
  type: PostVoteType!
}

type Community {
  name: String!
  purpose: String
  icon: String
  creator: User! @relation(name: "user_communities")
  posts: [Post!] @relation(name: "community_posts")
}

type Post {
  title: String!
  message: String!
  creator: User! @relation(name: "user_posts")
  community: Community! @relation(name: "community_posts")
  upVotes: Int!
  downVotes: Int!
  votes: [PostVote!] @relation(name: "post_votes")
  comments: [PostComment!] @relation(name: "post_comments")
}

type PostVote {
  post: Post! @relation(name: "post_votes")
  user: User! @relation(name: "user_post_votes")
  type: PostVoteType!
}

enum PostVoteType {
  UpVote
  DownVote
}

type PostComment {
  message: String!
  creator: User! @relation(name: "user_post_comments")
  post: Post! @relation(name: "post_comments")
}